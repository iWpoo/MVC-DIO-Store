<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/project/webroot/css/style.css">
    <link rel="stylesheet" type="text/css" href="/project/webroot/css/product.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto Mono">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Pacifico">
    <script src="/project/webroot/js/jquery-3.6.4.min.js"></script>
    <title>DIO</title>
</head>
<body>
    <header>
      <div class="container">
        <nav class="navbar">
            <div>
                <a href="#"><span class="active">–ì–ª–∞–≤–Ω–∞—è</span></a>
                <a href="#">–û –ú–∞–≥–∞–∑–∏–Ω–µ</a>
                <a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
            </div>
            <div>
                <a href="#">–í—Ö–æ–¥</a>
                <a href="#">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            </div>
        </nav>
        <hr>
         
        <div class="header">
            <a href="#" class="logo">DIO</a>
            <div class="search-container">
                <input type="text" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É –º–∞–≥–∞–∑–∏–Ω–∞">
                <button type="submit">–ù–∞–π—Ç–∏</button>
            </div>
            <div class="basket">
                <img src="/project/webroot/img/basket.png">
                <label>–ö–æ—Ä–∑–∏–Ω–∞</label>
            </div>
        </div>
      </div>
    </header>

    <main>
        
        <div class="product_container">
            <div class="product-gallery">
  <div class="product-image">
    <img src="/project/webroot/uploads/{{ product.image }}">
  </div>
  <div class="image-thumbnails">
    <img src="/project/webroot/uploads/{{ product.image }}">
    {% for img in product_images %}
      <img src="/project/webroot/uploads/{{ img.image }}">
  {% endfor %}
  </div>
</div>


<script>
    const thumbnails = document.querySelectorAll('.image-thumbnails img');
const mainImage = document.querySelector('.product-image img');

thumbnails.forEach((thumbnail) => {
  thumbnail.addEventListener('click', () => {
    mainImage.src = thumbnail.src;
    thumbnails.forEach((thumb) => thumb.classList.remove('active'));
    thumbnail.classList.add('active');
  });
});


</script>

            
            <div class="product_info">
                <div class="title">{{ product.title }} {{ product.memory }} {{ product.color }}</div>
                <div class="price">{{ product.price }}‚ÇΩ</div>

                {% if product.color or product.memory %}
                <div class="product_mod">
                    <label>–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏</label>
                    <ul>
                        {% for item in modification %}
                        {% if item.color or item.memory %}
                            <li class="{{ item.id is same as(product.id) ? 'active' : '' }}"><a href="/product/{{ item.id }}" id="link" class="modification">{{ item.color }} {{ item.memory }}</a></li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}

                <div class="product-buttons">
                    <button onclick="window.location = '/order/{{ product.id }}'" class="btn-buy">–ö—É–ø–∏—Ç—å —Å–µ–π—á–∞—Å</button>
                    <form>
                <input type="hidden" name="csrf_token" id="csrf_token" value="{{ csrf_token }}">
                {% if not auth %}
                    {% if not cart_local %}
                        <button class="btn-add" id="addCart" type="button"><span id="textCart">–í –∫–æ—Ä–∑–∏–Ω—É</span></button>
                    {% else %}
                        <button class="btn-add" id="deleteCart" type="button"><span id="textCart">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</span></button>
                    {% endif %}
                {% else %}
                    {% if not cart %}
                        <button class="btn-add" id="addCart" type="button"><span id="textCart">–í –∫–æ—Ä–∑–∏–Ω—É</span></button>
                    {% else %}
                        <button class="btn-add" id="deleteCart" type="button"><span id="textCart">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</span></button>
                    {% endif %}
                {% endif %}
            </form>
                <form>
                <input type="hidden" id="csrf_token" name="csrf_token" value="{{ csrf_token }}">
                {% if not auth %}
                <a href="/login"><img src="/project/webroot/img/unlike.png" style="cursor: pointer;" width="32px" height="32px"></a>
                {% else %}
                {% if favorite %}
                <button style="background: none; border: none; width: 0;" type="button" id="deleteFavorite" name="favorite">
                    <img src="/project/webroot/img/like.png" id="imgFavorite" style="cursor: pointer;" width="32px" height="32px">
                </button>
                {% elseif not favorite %}
                <button style="background: none; border: none; width: 0;" id="addFavorite" type="button" name="favorite">
                    <img src="/project/webroot/img/unlike.png" id="imgFavorite" style="cursor: pointer;" width="32px" height="32px">
                </button>
                {% endif %}
                {% endif %}
                
            </form>
                </div>
            </div>
        </div>

        <div class="parametr_info">
            <label>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</label>
            <div class="ch">
            {% for item in ch %}
            <div>
                <label class="name">{{ item.name }}</label><span>{{ item.value }}</span><br><br>
            </div>
            {% endfor %}
            </div>
        </div>

        <div class="similar_products">
            <div class="title-text">–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã</div>
            
            <div class="products">
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
                <div class="product">
                    <a href="#" class="picture"><img src="samsung.png"></a>
                    <a href="#" class="title"><span>Samsung Galaxy S22</span></a>
                    <a href="#" class="price"><span>1072$</span></a>
                </div>
            </div>
        </div> 

    </main>

    <footer>
        <div class="footer">
            <div class="subfooters">
                <div class="title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div><br>
                <ul class="footer-categories-list">
                    <li><a href="#">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</a></li>
                    <li><a href="#">–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã</a></li>
                    <li><a href="#">–ü–ª–∞–Ω—à–µ—Ç—ã</a></li>
                    <li><a href="#">–ù–∞—É—à–Ω–∏–∫–∏ –∏ –∫–æ–ª–æ–Ω–∫–∏</a></li>
                    <li><a href="#">–ß–∞—Å—ã</a></li>
                    <li><a href="#">–ì–∞–¥–∂–µ—Ç—ã</a></li>
                    <li><a href="#">–≠–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç—ã</a></li>
                    <li><a href="#">–ù–æ—É—Ç–±—É–∫–∏</a></li>
                </ul>
            </div>
    
            <div class="subfooters">
                <div class="title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div><br>
                <ul class="footer-categories-list">
                    <li><a href="#">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="#">–û –º–∞–≥–∞–∑–∏–Ω–µ</a></li>
                    <li><a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                </ul> 
            </div>
    
            <div class="subfooters">
                <div class="title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div><br>
                <ul class="footer-categories-list">
                    <li>EMAIL: dio@gmail.com</li>
                    <li>+7 (7777) 777-77-77</li>
                </ul>  
            </div>
            </div>
        <hr>
        <div class="icons">
            <a href="#"><img class="icon" src="instagram.png"></a>
            <a href="#"><img class="icon" src="telegram.png"></a>
            <a href="#"><img class="icon" src="twitter.png"></a>
            <a href="#"><img class="icon" src="vk.png"></a>
        </div>
    </footer>

    

    <div class="MobileShowNavigation">
        <div class="button-buy-mobile">
            <form>
                <input type="hidden" id="csrf_token" name="csrf_token" value="{{ csrf_token }}">
                {% if not auth %}
                    {% if not cart_local %}
                        <button id="addCartMobile" type="button"><span id="textCartMobile">–í –∫–æ—Ä–∑–∏–Ω—É</span></button>
                    {% else %}
                        <button id="deleteCartMobile" type="button"><span id="textCartMobile">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</span></button>
                    {% endif %}
                {% else %}
                    {% if not cart %}
                        <button id="addCartMobile" type="button"><span id="textCartMobile">–í –∫–æ—Ä–∑–∏–Ω—É</span></button>
                    {% else %}
                        <button id="deleteCartMobile" type="button"><span id="textCartMobile">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</span></button>
                    {% endif %}
                {% endif %}
            </form>
            <button type="submit" onclick="window.location = '/order/{{ product.id }}'">–ö—É–ø–∏—Ç—å</button>
            <form>
                <input type="hidden" name="csrf_token" id="csrf_token" value="{{ csrf_token }}">
                {% if not auth %}
                <a href="/login"><img src="/project/webroot/img/green_like.png" style="cursor: pointer;" width="32px" height="32px"></a>
                {% else %}
                    {% if favorite %}
                <button style="background: none; border: none; width: 100%;" type="button" id="deleteFavoriteMobile" name="favorite">
                    <img src="/project/webroot/img/like.png" id="imgFavoriteMobile" style="cursor: pointer;" width="32px" height="32px">
                </button>
                {% elseif not favorite %}
                <button style="background: none; border: none; width: 100%;" type="button" id="addFavoriteMobile" name="favorite">
                    <img src="/project/webroot/img/green_like.png" id="imgFavoriteMobile" style="cursor: pointer;" width="32px" height="32px">
                </button>
                {% endif %}
                {% endif %}
            </form>
        </div>
        <div class="menu">
        <img src="/project/webroot/img/home.png">
        <img src="/project/webroot/img/category.png">
        <img src="/project/webroot/img/basketicon.png">
        <a href=""><img src="/project/webroot/img/profile.png"></a>
    </div>
    </div>

    <script>
        function reloadPage(csrf, element) {
    let currentSrc = $('#imgFavorite, #imgFavoriteMobile').attr("src");
    let textCart = $('#textCart, #textCartMobile');
            $.ajax({
  url: '/product/{{ product.id }}', // –∞–¥—Ä–µ—Å –º–µ—Ç–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
  method: 'POST', // –º–µ—Ç–æ–¥ –∑–∞–ø—Ä–æ—Å–∞
  dataType: 'html', // —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–∂–∏–¥–∞–µ–º –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
  data: {}, // –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
  success: function(data) {
    $('#csrf_token').val(csrf);
    if (element === 'favorite') {
        if (currentSrc === "/project/webroot/img/unlike.png") {
    $('#imgFavorite, #imgFavoriteMobile').attr("src", "/project/webroot/img/like.png");
  } else {
    $('#imgFavorite, #imgFavoriteMobile').attr("src", "/project/webroot/img/unlike.png");
  }
    } else if (element === 'cart') {
        if (textCart.html() === '–í –∫–æ—Ä–∑–∏–Ω—É') {
            textCart.html('–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
        } else {
            textCart.html('–í –∫–æ—Ä–∑–∏–Ω—É');
        }
    }
  },
  error: function(xhr, status, error) {
    console.log(error); // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  }
});
}

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
        $("#addFavorite, #addFavoriteMobile").on("click", function() {
            let csrf = $('#csrf_token').val();
            $.ajax({
                url: '/product/favorite/{{ product.id }}',
                type: 'POST',
                cache: false,
                data: {'csrf_token': csrf},
                dataType: 'html',
                success: function (data) {
                    reloadPage(data, 'favorite');
                }
            });
        });

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
        $("#deleteFavorite, #deleteFavoriteMobile").on("click", function() {
            let csrf = $('#csrf_token').val();
            $.ajax({
                url: '/product/favorite/{{ product.id }}',
                type: 'POST',
                cache: false,
                data: {'csrf_token': csrf},
                dataType: 'html',
                success: function (data) {
                    reloadPage(data, 'favorite');
                }
            });
        });

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–∫—É
        $("#addCart, #addCartMobile").on("click", function() {
            let csrf = $('#csrf_token').val();
            $.ajax({
                url: '/product/cart/{{ product.id }}',
                type: 'POST',
                cache: false,
                data: {'csrf_token': csrf},
                dataType: 'html',
                success: function (data) {
                    reloadPage(data, 'cart');   
                }
            });
        });

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω–∫–∏
        $("#deleteCart, #deleteCartMobile").on("click", function() {
            let csrf = $('#csrf_token').val();
            $.ajax({
                url: '/product/cart/{{ product.id }}',
                type: 'POST',
                cache: false,
                data: {'csrf_token': csrf},
                dataType: 'html',
                success: function (data) {
                    reloadPage(data, 'cart');   
                }
            });
        });
    </script>
</body>

</html>